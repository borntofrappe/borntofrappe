<script>
	const lifepoints = 3;
</script>

<svg viewBox="0 0 80 50">
	<rect fill="#86bded" width="80" height="50" />
	<g>
		<path
			fill="#f9e382"
			d="m80 17.1c-2.41 0.896-4.84 1.7-7.3 2.29-11.2 3.07-22.7 5.13-34.2 4.34-11.2 0.828-22.5-1.36-33.4-4.36-1.71-0.511-3.41-1.07-5.1-1.66v32.3h80z"
		/>
		<path
			fill="#f1f6f6"
			d="m44.2 2.2c-2.31 0.012-4.63 0.107-6.9 0.223-4.92 0.375-10.2 0.752-14.3 2.35-3.31 0.989 2.3 3.01-1.47 3.71-3.38 0.216-3.09 2.07-4.12 3.28-3.04-0.0531-4.02 1.55-6.84 1.94-0.769 1.44 4.02 0.709 5.71 1.11 2.52 0.322 5.53 0.567 7.22 1.72 0.726 0.448 2.03 0.436 3.04 0.559 7.52 0.441 15.2 0.434 22.7-0.165 2.81-0.437 5.24-1.35 8.24-1.5 2.07-0.521 4.6-1.05 5.67-2.2-0.503-1.55-2.11-2.97-3.97-4.16-2.95-0.59-0.54-1.42 0.594-2.21 1.11-1.58-1.71-3.16-4.24-3.74-3.62-0.733-7.47-0.945-11.3-0.925zm-38.5 0.533c-0.208 0.00548-0.42 0.0197-0.639 0.0422-2.97 0.46-1.64 2.77-2.25 4.02 0.532 1.35-2.48 3.06 0.0918 4.01 3.42 0.87 7.78 0.774 11.2-0.104 2.67-1.36-0.487-3.61-1.71-5.04-1.57-1.25-3.54-3-6.66-2.91zm70.4 0.0507c-3.51 0.0451-0.545 2.92-3.04 3.67-3.41-0.112-3.31 1.81-5.15 2.73-2.02 0.0743-3.97 1.52-0.975 1.82 2.58 0.3 5.5 0.884 8.05 0.273 2.38-0.863 2.06-2.65 2.2-4.01-0.281-1.46 0.599-3.25-1.09-4.49z"
		/>
		<path
			fill="#59a258"
			d="m1.5 20.6c-0.569-0.0163-1.08 0.104-1.5 0.434v17.8c1.11 2.14 0.803-5.06 3.16-4.66 2.51-0.0983 5.46-0.89 4.21-4.62 2.56-1.37 5.87-0.618 8.6-2.03 2.24-0.466 5.94-3.24 7.42-1.74-3.29 3.43-7.66 4.99-11.2 8.08-0.66 2.34-3.63 1.34-3.68 3.76 2.15 5.05-3.04 5.21-5.59 6.98-0.58 1.48-1.97 1.32-2.96 1.6v2.94c0.0596 0.0112 0.117 0.0334 0.178 0.0352 4.04 0.239 8.13-0.226 12.1-1.09 4.91-0.925 0.101-3.48-2.2-3.57-0.14-1.88 4.84-1.19 6.44-2.48 2.61-0.641 2.39-4.54-0.531-3.77-0.322-0.545 1.94-2.1 0.332-3.54-1.93-3.17 2.44-1.88 3.16-4.31 1.94-2.23 9.57-4.45 6.49-5.88-1.78-0.403-0.868-0.642-2.48-1.54-2.09-1.15-5.64-2.3-8.03 0.199-2.83 0.527-5.54-1.64-8.49-1.43-1.52 0.17-3.75-1.07-5.49-1.12zm78.3 0.338c-4.96 0.398-9.9 1.21-14.9 1.7-3.55 0.598-7.24 0.14-10.7 1.36-2.34 2.01 1.52-0.825 1.25 1.68-0.45 3.5 1.74 5.63 3.6 7.82 1.87 2.32-3.02 2.64-0.135 3.72 2.67 0.961 0.172 1.19-1.2 1.26-4.63 2.46 5.2 2.01 1.84 4.42-1.2 0.471-6.58 0.103-4.58 2.45 3.9 0.469 7.92-1.29 11.8 0.219 4.17 1.84-1.71 0.508-2.69 2.51 0.228 1.52 2.72 0.951 3.75 1.2 2.86 0.593 6.82-0.406 5.32-4.82-2-1.53-3.1-4.86-4.92-6.96-3.09-1.34-5.03-4.86-8.06-6.31-0.0266-2.08-1.61-4.41-3.57-5.65 1.78-0.302 4.55 1.04 6.54 1.89 2.79 1.55 6.44 3.66 6.67 7.76-0.104 2.96 0.821 0.671 1.28-0.715 1.87 0.793 1.97 4.94 3.44 6.87 0.773 3.56 4.06 1.56 5.43 3.22v-23.3c-0.062-0.0974-0.12-0.198-0.189-0.291z"
		/>
		<path
			fill="#455f58"
			d="m3.31 15.7c-1.13 0.0716-2.41 0.9-3.31 1.94v4.1c0.0176 0.0077 0.0288 0.0184 0.0469 0.0259 3.02 1.39 8.21 1.48 11.4 2.23 0.5 0.091 1 0.18 1.5 0.262 1.88 0.362 7.33 1.15 6.74-2.11-2.86-1.66-6.22-0.5-9.19-1.84-3.19 0.0323-3.83-4.37-6.61-4.57-0.172-0.03-0.351-0.0398-0.533-0.0283zm76.4 1.1c-4.77 2.67-10.6 0.0538-15.5 2.41-2.7 2.85-7.43 2.41-10.3 4.7-1.1 1.05 1.47 4.96 2.8 4.04 5.88-3.03 16-3.72 22.8-4.54 0.205 0.0797 0.39 0.127 0.561 0.149v-6.37c-0.106-0.144-0.215-0.278-0.328-0.394z"
		/>
	</g>

	<g transform="translate(1 1)">
		<g display="none">
			<animate
				attributeName="display"
				to="initial"
				dur="0.1s"
				fill="freeze"
				calcMode="discrete"
				begin="battleGameStart.begin"
			/>
			<rect fill="currentColor" stroke="#fff" width="20" height="11" rx="1" />
			<g transform="translate(10 4.6)">
				<g
					fill="#fff"
					font-family="sans-serif"
					font-size="4"
					font-weight="bold"
					text-anchor="middle"
				>
					<text>Enemy</text>
					<g transform="translate(0 4.6)">
						<text
							>HP:
							{#each Array(lifepoints + 1) as _, i}
								<tspan display={i === lifepoints ? 'initial' : 'none'}>
									{#if i !== lifepoints}
										<animate
											attributeName="display"
											to="initial"
											dur="0.1s"
											fill="freeze"
											calcMode="discrete"
											begin="battleGameHit{i}.begin"
										/>
									{/if}
									{#if i > 0}
										<animate
											attributeName="display"
											to="none"
											dur="0.1s"
											fill="freeze"
											calcMode="discrete"
											begin="battleGameHit{i - 1}.begin"
										/>
									{/if}
									{i}
								</tspan>
							{/each}
						</text>
					</g>
				</g>
			</g>
		</g>
	</g>

	<g transform="translate(1 38)">
		<g display="none">
			<animate
				attributeName="display"
				to="initial"
				dur="0.1s"
				fill="freeze"
				calcMode="discrete"
				begin="battleGameStart.begin"
			/>
			<rect fill="currentColor" stroke="#fff" width="78" height="11" rx="1" />

			<g transform="translate(39 6.8)">
				<g
					fill="#fff"
					font-family="sans-serif"
					font-size="4"
					font-weight="bold"
					text-anchor="middle"
				>
					{#each Array(lifepoints + 1) as _, i}
						<g display={i === lifepoints ? 'initial' : 'none'}>
							{#if i !== lifepoints}
								<animate
									attributeName="display"
									to="initial"
									dur="0.1s"
									fill="freeze"
									calcMode="discrete"
									begin="battleGameHit{i}.begin"
								/>
							{/if}
							{#if i > 0}
								<animate
									attributeName="display"
									to="none"
									dur="0.1s"
									fill="freeze"
									calcMode="discrete"
									begin="battleGameHit{i - 1}.begin"
								/>
							{/if}
							<text>
								{#if i === lifepoints}
									{#each 'An enemy appeared!'.split('') as l, j}
										<tspan fill-opacity="0">
											<animate
												attributeName="fill-opacity"
												to="1"
												dur="0.025s"
												fill="freeze"
												id="message{i}Letter{j}"
												calcMode="discrete"
												begin={j === 0 ? 'battleGameStart.end' : `message${i}Letter${j - 1}.end`}
											/>
											{l}
										</tspan>
									{/each}
								{:else}
									{#each `${i === 0 ? 'You defeated the enemy!' : 'You hit for 1 point!'}`.split('') as l, j}
										<tspan fill-opacity="0">
											<animate
												attributeName="fill-opacity"
												to="1"
												dur="0.025s"
												fill="freeze"
												id="message{i}Letter{j}"
												calcMode="discrete"
												begin={j === 0 ? `battleGameHit${i}.end` : `message${i}Letter${j - 1}.end`}
											/>
											{l}
										</tspan>
									{/each}
								{/if}
							</text>
						</g>
					{/each}
				</g>
			</g>
		</g>
	</g>

	<g transform="translate(40 24)">
		<g fill="#fff" stroke="currentColor" stroke-width="0.75">
			{#each Array(lifepoints) as _, i}
				<g display="none">
					<animate
						attributeName="display"
						to="initial"
						dur="0.1s"
						fill="freeze"
						calcMode="discrete"
						begin={i === lifepoints - 1 ? 'battleGameStart.begin' : `battleGameHit${i + 1}.begin`}
					/>
					{#if i !== lifepoints - 1}
						<animate
							attributeName="opacity"
							values="1;0;1"
							repeatCount="2"
							dur="0.2s"
							calcMode="discrete"
							begin="battleGameHit{i + 1}.begin"
						/>
					{/if}

					<animate
						attributeName="display"
						to="none"
						dur="0.1s"
						fill="freeze"
						calcMode="discrete"
						id="battleGameHit{i}"
						begin="click"
					/>

					<g>
						<path
							d="M 3.5 -0.75 l 3.5 3.5 a 2 2 0 1 1 -2 2 l -1 -1 v 4 q 2 0 2 2 0 1 -1 1 h -2.5 q -2 0 -2 -2 v -1 q 0 -0.5 -0.5 -0.5 -0.5 0 -0.5 0.5 v 1 q 0 2 -2 2 h -2.5 q -1 0 -1 -1 0 -2 2 -2 v -4 l -1 1 a 2 2 0 1 1 -2 -2 l 3.5 -3.5"
						/>
						<circle cy="-2.5" r="5" />
						<circle cx="1.8" cy="-3.5" r="0.9" />
						<circle cx="-1.8" cy="-3.5" r="0.9" />
						<rect x="-1.7" y="-1" width="3.4" height="1.7" rx="1" />
					</g>
				</g>
			{/each}
		</g>
	</g>

	<g transform="translate(40 25)">
		<g
			style="pointer-events: none;"
			font-size="7"
			font-weight="bold"
			font-family="sans-serif"
			text-anchor="middle"
			dominant-baseline="middle"
			fill="#f7f7f7"
			stroke="currentColor"
			stroke-width="0.3"
		>
			<animate
				attributeName="opacity"
				to="0"
				fill="freeze"
				dur="0.1s"
				begin="battleGameStart.begin"
			/>
			<text> Battle! </text>
		</g>
	</g>

	<rect style:cursor="pointer" width="80" height="50" opacity="0">
		<animate
			id="battleGameStart"
			attributeName="display"
			to="none"
			fill="freeze"
			begin="click"
			dur="0.1s"
			restart="never"
		/>
	</rect>

	<g transform="translate(-80 0)">
		<animateTransform
			attributeName="transform"
			by="80 0"
			additive="sum"
			calcMode="discrete"
			fill="freeze"
			begin="battleGameHit0.end + 2s"
			id="battleGameMessage"
			dur="0.1s"
		/>

		<g transform="translate(40 25)">
			<g
				style="pointer-events: none;"
				font-size="6"
				font-weight="bold"
				font-family="sans-serif"
				text-anchor="middle"
				dominant-baseline="middle"
				fill="#f7f7f7"
				stroke="currentColor"
				stroke-width="0.3"
			>
				<animateTransform
					attributeName="transform"
					type="translate"
					to="0 1"
					dur="0.25s"
					repeatCount="indefinite"
					begin="battleGameMessage.begin"
					end="battleGameEnd.end"
					fill="freeze"
					calcMode="discrete"
				/>
				<text>
					{#each 'Congratulations!'.split('') as l, i}
						<tspan dx="0.5" dy={i % 2 === 0 ? 0.5 : -0.5}>{l}</tspan>
					{/each}
				</text>
			</g>
		</g>

		<rect style:cursor="pointer" width="80" height="50" opacity="0">
			<animate
				attributeName="display"
				to="none"
				fill="freeze"
				begin="click"
				restart="never"
				dur="0.1s"
				id="battleGameEnd"
			/>
		</rect>
	</g>
</svg>
