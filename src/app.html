<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <script>
      try {
        function setPreference(preference) {
          document.documentElement.setAttribute('data-preference', preference);
          localStorage.setItem('color-scheme', preference);
        }

        const prefersColorScheme = matchMedia('(prefers-color-scheme: dark)');
        const colorScheme = localStorage.getItem('color-scheme');

        if (colorScheme) {
          setPreference(colorScheme);
        } else {
          setPreference(prefersColorScheme.matches ? 'dark' : 'light');
        }
      } catch (e) {
        console.error(e);
      }

      if (sessionStorage.webfontLoaded) {
        document.documentElement.classList.add('webfont-loaded');
      } else {
        if ('fonts' in document) {
          Promise.all([
            document.fonts.load('1em Cantarell'),
            document.fonts.load('700 1em CantarellBold'),
            document.fonts.load('italic 1em CantarellItalic'),
            document.fonts.load('italic 700 1em CantarellBoldItalic'),
            document.fonts.load('700 1em JosefinsansBold'),
          ]).then(() => {
            sessionStorage.webfontLoaded = true;
            document.documentElement.classList.add('webfont-loaded');
          });
        }
      }
    </script>

    %svelte.head%
  </head>
  <body>
    <div id="svelte">%svelte.body%</div>
  </body>
</html>
